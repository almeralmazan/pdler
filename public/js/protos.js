
var SNULL=-1;var protos={};protos.Browser={width:0,height:0,widthOffset:16,heightOffset:16};protos.uistage={};protos.utils={};protos.Browser.update=function(){if(document.documentElement &&(typeof(document.documentElement.clientWidth)=="number"   || typeof(document.documentElement.clientHeight)=="number")){protos.Browser.width=document.documentElement.clientWidth;protos.Browser.height=document.documentElement.clientHeight;}if(typeof(window.innerWidth)=='number'){protos.Browser.width=window.innerWidth;protos.Browser.height=window.innerHeight;}else if(protos.Browser.width==0 &&  document.body &&(typeof(document.body.clientWidth)=="number"  || typeof(document.body.clientHeight)=="number")){protos.Browser.width=document.body.clientWidth;protos.Browser.height=document.body.clientHeight;}if(navigator.appName.indexOf("Microsoft")!=-1){protos.Browser.type="IE";}else{protos.Browser.type="nonIE";}};protos.System=function(){};protos.System.timeout=10;protos.System.update=function(){for(var i in protos.uistage){var stg=protos.uistage[i];if(stg!=null){stg.uintCtr+=protos.System.timeout;if(stg.uintCtr>=stg.updateInterval){stg.uintCtr=0;stg.frameUpdate();}}}};var protosx;protos.inherit=function(target,source,override){var tmp={};if(override!=null){for(var octr=0;octr<override.length;octr++){var m=override[octr];tmp[m]=target[m];}}for(var i in source){target[i]=source[i];}for(var o in tmp){target[o]=tmp[o];}};protos.delegate=function(obj,method){var f=function(p){obj[method](p);};return f;};protos.onResize=function(){protos.Browser.update();for(var i in protos.uistage){var s=protos.uistage[i];s.update();}};protos.decodeUIArgument=function(a){var p={};if(a!=null){var arg=a[0];for(var i in arg){p[i]=arg[i];}}return p;};protos.urlEncode=function(data){var params="";if(data!=null){for(var  i in data){params+=""+i+"="+data[i]+"&";}params=params.substring(0,params.length-1);}return params;};protos.encodeJSON=function(str){try{eval("var obj = "+str);return obj;}catch(err){throw "protos.encodeJSON() Error encoding "+str;}return null;};protos.classDefByName=function(n){var c=null;try{c=eval(n);}catch(err){return null;}return c;};protos.navigateURL=function(url,wintype){window.open(url,wintype);};protos.Object=function(){this.className="protos.Object"};protosx=protos.Object;protosx.prototype.className="protos.Object";window.onresize=protos.onResize;
protos.Event=function(type,bubble,cancelable,data){protos.inherit(this,new protos.Object());this.type=type;this.className="protos.events.Event";this.bubble=bubble;this.cancelable=cancelable;this.data=data;};protosx=protos.Event;protosx.prototype.type="";protosx.prototype.bubble=false;protosx.prototype.cancelable=false;protosx.prototype.data=null;protosx.prototype.source=null;protosx.prototype.clone=function(){var clone=new protos.Event(this.type,this.bubble,this.cancelable,this.data);clone.source=this.source;return clone;};protosx.COMPLETE="complete";protosx.RENDER="render";protosx.PROGRESS="progress";protosx.ADDED="added";protosx.ADDED_TO_STAGE="addedToStage";protosx.FRAME_UPDATE="frameUpdate";protosx.REMOVE="remove";protosx.REMOVE_TO_STAGE="removeToStage";protosx.RESIZE="resize";protosx.REDRAW="redraw";protosx.DATA_EVENTS=["change" ];protosx.KEY_EVENTS=["keypress","keyup","keydown"    ];protosx.FOCUS_EVENTS=["blur","focus","select" ];protosx=null;
protos.EventDispatcher=function(){protos.inherit(this,new protos.Object());this.eventHash=[];this.className="protos.events.EventDispatcher";};protosx=protos.EventDispatcher;protosx.prototype.eventHash=null;protosx.prototype.addEventListener=function(type,listener,method){if(this.validateListeners(type,listener,method)==null){this.eventHash.push({type:type,listener:listener,method:method})}};protosx.prototype.validateListeners=function(type,listener,method){for(var i=0;i<this.eventHash.length;i++){var obj=this.eventHash[i];if(type==obj.type && listener==obj.listener && method==obj.method){return obj;}}return null;};protosx.prototype.removeEventListener=function(type,listener,method){for(var i=0;i<this.eventHash.length;i++){var obj=this.eventHash[i];if(type==obj.type && listener==obj.listener && method==obj.method){this.eventHash.splice(i,1);break;}}};protosx.prototype.dispatchEvent=function(event){for(var i=0;i<this.eventHash.length;i++){var obj=this.eventHash[i];if(obj.type==event.type){event.source=this;if(obj.listener!=null){obj.listener[obj.method ](event);}else{obj.method(event);}}}var char=event.type.substr(0,1);var onType="on"+char.toUpperCase()+event.type.substr(1,event.type.length-1);if(this[onType]!=null){this[onType](event);}};protosx.prototype.haprotostListener=function(type){for(var i=0;i<this.eventHash.length;i++){var obj=this.eventHash[i];if(obj.type==type){return true;}}return false;};protosx.prototype.bind=protos.EventDispatcher.prototype.addEventListener;protosx.prototype.unbind=protos.EventDispatcher.prototype.removeEventListener;protosx.prototype.fire=protos.EventDispatcher.prototype.dispatchEvent;protosx=null;
protos.Point=function(x,y){this.x=x;this.y=y;};protosx=protos.Point;protosx.prototype.x=0;protosx.prototype.y=0;protosx.prototype.toString=function(){return  "point ("+this.x+", "+this.y+")";};protos.geom={};protos.geom.getUnRotatedPosition=function(origin,target,rotation){var dx=target.x-origin.x;var dy=target.y-origin.y;var deg=Math.atan(dy/dx)*(180/Math.PI);if(isNaN(deg))deg=0;deg=Math.abs(deg);if(dx>=0 && dy>=0){deg=deg;}else if(dx<0 && dy>=0){deg=90+(90-deg);}else if(dx<0 && dy<0){deg=180+deg;}else  if(dx>=0 && dy<0){deg=270+(90-deg);}var radian=(deg+rotation)*(Math.PI/180);var radius=Math.sqrt(dx*dx+dy*dy);var np=new protos.Point(0,0);np.x=Math.cos(radian)*radius;np.y=Math.sin(radian)*radius;return np;};protos.geom.getAbsolutePosition=function(target,point){if(target.parent!=null && target.parent.className!="protos.display.Stage"){var unrot;if(point==null){unrot=protos.geom.getUnRotatedPosition(new protos.Point(0,0),new protos.Point(target.x,target.y),target.parent.rotation);}else{unrot=protos.geom.getUnRotatedPosition(new protos.Point(0,0),new protos.Point(point.x,point.y),target.parent.rotation);}return protos.geom.getAbsolutePosition(target.parent,new protos.Point(target.parent.x+unrot.x,target.parent.y+unrot.y));}if(point==null)return new protos.Point(target.x,target.y);return new protos.Point(point.x,point.y);};protos.geom.getOverAllRotation=function(target){if(target.parent!=null && target.parent.className!="protos.display.Stage"){return target.rotation+protos.geom.getOverAllRotation(target.parent);}return target.rotation;};protos.geom.globalToLocal=function(target,globalPoint){var targetAngle=protos.geom.getOverAllRotation(target);if(targetAngle>360)targetAngle=targetAngle-360;var absp=protos.geom.getAbsolutePosition(target,null);var dx=Math.abs(absp.x-globalPoint.x);var dy=Math.abs(absp.y-globalPoint.y);var radius=Math.sqrt(dx*dx+dy*dy);var atan=Math.atan(dy/dx);if(isNaN(atan))atan=0;var angle=180*atan/Math.PI;var finalAngle=0;if(absp.x<globalPoint.x && absp.y<globalPoint.y){finalAngle=angle;}else if(absp.x>=globalPoint.x && absp.y<globalPoint.y){finalAngle=90+(90-angle);}else if(absp.x>=globalPoint.x && absp.y>=globalPoint.y){finalAngle=180+angle;}else if(absp.x<globalPoint.x && absp.y>=globalPoint.y){finalAngle=270+(90-angle);}finalAngle=finalAngle-targetAngle;var finalRadian=Math.PI*finalAngle/180;var nx=Math.round(Math.cos(finalRadian)*radius);var ny=Math.round(Math.sin(finalRadian)*radius);return new protos.Point(nx,ny);};protos.geom.localToGlobal=function(target,localPoint){var unrot=protos.geom.getUnRotatedPosition(new protos.Point(0,0),localPoint,target.rotation);var p=protos.geom.getAbsolutePosition(target,new protos.Point(target.x+unrot.x,target.y+unrot.y));p.x=Math.round(p.x);p.y=Math.round(p.y);return p;};protos.geom.localToGlobalMouse=function(ui,point){if(ui.parent==null){return point;}if(ui.className!="protos.display.Stage"){var np=new protos.Point(ui.x+point.x,ui.y+point.y);return protos.geom.localToGlobalMouse(ui.parent,np);}else if(ui.className!="protos.display.Stage"){return point;}};
protos.Rectangle=function(){this.x=0;this.y=0;this.width=0;this.height=0;if(arguments[0]!=null){var o=arguments[0];for(var i in o){this[i]=o[i];}}};protosx=protos.Rectangle;protosx.prototype.x=0;protosx.prototype.y=0;protosx.prototype.width=0;protosx.prototype.height=0;protosx.prototype.toString=function(){return  "rectangle ("+this.x+", "+this.y+", "+this.width+", "+this.height+")";};
protos.UIDisplay=function(){this.styleName=null;this.rotation=0;this.scaleX=1;this.scaleY=1;this.children=[];this.position="absolute";this.parent=null;this.stage=null;this.offsets={};this.mouseX=0;this.mouseY=0;this.showContextMenu=true;this.dragActive=false;protos.inherit(this,new protos.EventDispatcher());if(arguments!=null){var props=arguments[0];for(var i in  props){if(this[i]!=undefined){this[i]=props[i];}}}this.userSelect="none";this.className="protos.display.UIDisplay";this.uid=protos.UIDisplay.generateUID();this.name=this.className+"_"+this.uid;this.id=this.name;this.toElement();this.configureMouseDelegation();this.updateUserSelect();};protos.UIDisplay.count=0;protos.UIDisplay.generateUID=function(){var rand=Math.floor(Math.random()*100000);protos.UIDisplay.count++;return ""+protos.UIDisplay.count+"_"+rand;};protosx=protos.UIDisplay;protosx.prototype.uid=-1;protosx.prototype.id="";protosx.prototype.name="";protosx.prototype.element=-1;protosx.prototype.x=0;protosx.prototype.y=0;protosx.prototype.offsets=null;protosx.prototype.width=0;protosx.prototype.height=0;protosx.prototype.alpha=1;protosx.prototype.rotation=0;protosx.prototype.rotation=0;protosx.prototype.rotation=0;protosx.prototype.scaleX=1;protosx.prototype.scaleY=1;protosx.prototype.style="";protosx.prototype.tag="div";protosx.prototype.position="absolute";protosx.prototype.bgColor=-1;protosx.prototype.children=null;protosx.prototype.parent=null;protosx.prototype.stage=null;protosx.prototype.index=-1;protosx.prototype.mouseEnabled=true;protosx.prototype.mouseMoveEnabled=false;protosx.prototype.mouseX=0;protosx.prototype.mouseY=0;protosx.prototype.styleName=null;protosx.prototype.clipContent=false;protosx.prototype.showContextMenu=false;protosx.prototype.dragActive=false;protosx.prototype.userSelect="text";protosx.prototype.useHandCursor=function(v){if(v){this.element.style.cursor="pointer";}else{this.element.style.cursor="default";}};protosx.prototype.setCornerRadius=function(tl,tr,bl,br){this.element.style.borderRadius=tl+"px "+tr+"px "+br+"px "+bl+"px";this.element.style.mozBorderRadius=tl+"px "+tr+"px "+br+"px "+bl+"px";this.element.style.webkitBorderRadius=tl+"px "+tr+"px "+br+"px "+bl+"px";};protosx.prototype.setClipContent=function(value){this.clipContent=value;if(this.clipContent){var clipRect="rect( "+0+"px, "+(this.width)+"px, "+(this.height)+"px, "+0+"px )";this.element.style.clip=clipRect;}};protosx.prototype.redraw=function(redrawChildren){protos.UIDisplay.commitProperties(this);protos.UIDisplay.uiTransform(this);if(redrawChildren==true && this.children!=null && this.children.length>0){for(var i=0;i<this.children.length;i++){var child=this.children[i];child.redraw(redrawChildren);}}if(this.redrawCallback!=null){this.redrawCallback();}this.fire(new protos.Event("redraw"));};protosx.prototype.transform=function(props){for(var i in  props){this[i]=props[i];}this.redraw(false);};protosx.prototype.setId=function(id){this.id=id;this.name=id;this.element.setAttribute("id",id);this.configureMouseDelegation();this.updateUserSelect();this.element.__ui=this;};protosx.prototype.updateUserSelect=function(){var e=this.element;if(this.userSelect=="none"){e.style.MozUserSelect="-moz-none";}else{e.style.MozUserSelect=this.userSelect;}e.style.khtmlUserSelect=this.userSelect;e.style.webkitUserSelect=this.userSelect;e.style.oUserSelect=this.userSelect;e.style.userSelect=this.userSelect;};protosx.prototype.configureMouseDelegation=function(){if(this.mouseEnabled){this.element.onmouseup=protos.delegate(this,"internal_mouseUp");this.element.onmouseover=protos.delegate(this,"internal_mouseOver");this.element.onmousedown=protos.delegate(this,"internal_mouseDown");this.element.onmouseout=protos.delegate(this,"internal_mouseOut");if(this.mouseMoveEnabled){this.element.onmousemove=protos.delegate(this,"internal_mouseMove");}this.element.onclick=protos.delegate(this,"internal_click");this.element.ondblclick=protos.delegate(this,"internal_doubleClick");}else{this.element.onmouseup=null;this.element.onmouseover=null;this.element.onmousedown=null;this.element.onmouseout=null;this.element.onmousemove=null;this.element.onclick=null;this.element.ondblclick=null;}};protosx.prototype.configureKeyListeners=function(){this.element.onkeyup=protos.delegate(this,"internal_keyUp");this.element.onkeydown=protos.delegate(this,"internal_keyDown");this.element.onkeypress=protos.delegate(this,"internal_keyPress");};protosx.prototype.setMouseEnabled=function(enable,mouseMoveEnable){if(enable==false){this.element.style.pointerEvents="none";}else{this.element.style.pointerEvents = "auto";}this.mouseEnabled=enable;this.mouseMoveEnabled=mouseMoveEnable;this.configureMouseDelegation();};protosx.prototype.setStyleName=function(styleName){if(styleName!=null){this.element.className=this.styleName=styleName;}};protosx.prototype.consideredAsStyle=function(style){if(style=="left")return false;if(style=="top")return false;if(style=="width")return false;if(style=="height")return false;return true;};protosx.prototype.setStyles=function(styles){if(styles!=null){for(var i in styles){if(this.consideredAsStyle(i)){this.element.style[i]=styles[i];}}}};protosx.prototype.toElement=function(){if(this.element==-1){var e=document.createElement(this.tag);if(this.showContextMenu==false){e.oncontextmenu=function(){return false};}e.setAttribute("id",this.id);this.element=e;e.__ui=this;if(this.styleName!=null){this.element.className=this.styleName;}protos.UIDisplay.commitProperties(this);protos.UIDisplay.uiTransform(this);}};protosx.prototype.addUI=function(child){child.parent=this;this.children.push(child);this.renderChildren();protos.UIDisplay.addRoot(child);};protosx.prototype.addUIAt=function(child,index){child.parent=this;if(this.children.length<=0 || this.children.length<index){this.children.push(child);}else if(index<this.children.length){this.children.splice(index,0,child);}this.renderChildren();protos.UIDisplay.addRoot(child);};protosx.prototype.renderChildren=function(){while(this.element.childNodes.length>0){var c=this.element.childNodes[0];this.element.removeChild(c);}for(var i=0;i<this.children.length;i++){var nc=this.children[i];nc.index=i;this.element.appendChild(nc.element);}};protosx.prototype.swap=function(index1,index2){if(index1<this.children.length && index2<this.children.length && index1!=index2){var c1=this.getUIAt(index1);var c2=this.getUIAt(index2);c1.index=index2;c2.index=index1;if(index1>index2){this.children.splice(index1,1,c2);this.children.splice(index2,1,c1);}else if(index2>index1){this.children.splice(index2,1,c1);this.children.splice(index1,1,c2);}this.renderChildren();}};protosx.prototype.getUIAt=function(index){if(index<this.children.length){return this.children[index];}return null;};protosx.prototype.removeUI=function(child){this.element.removeChild(child.element);var childSpliced=false;for(var i=0;i<this.children.length;i++){var c=this.children[i];if(childSpliced==true){c.index=i;continue;}if(c.uid==child.uid){this.children.splice(i,1);child.index=-1;child.parent=null;childSpliced=true;i--;}}};protosx.prototype.startDrag=function(bounds){if(this.stage!=null && this.dragActive==false){this.dragActive=true;this.stage.dragBounds=bounds;this.stage.dragTarget=this;this.stage.dragStart=new protos.Point(this.stage.mouseX,this.stage.mouseY);this.stage.dragTStart=new protos.Point(this.x,this.y);/*this.stage.element.style.cursor="hand";*/}};protosx.prototype.stopDrag=function(){this.dragActive=false;this.stage.dragTarget=null;this.stage.dragStart=null;this.stage.dragTStart=null;};protosx.mouseTarget=null;protosx.prototype.finalPreProcessEvent=function(type){if(this.preProcessEvent!=null){this.preProcessEvent(type)}};protosx.prototype.fireMouse=function(type,e){this.finalPreProcessEvent(type);if(e==null)e=window.event;this.fire(new protos.Event(type,true,true,e));};protosx.prototype.internal_mouseUp=function(e){this.fireMouse("mouseUp",e);};protosx.prototype.internal_mouseOver=function(e){this.fireMouse("mouseOver",e);};protosx.prototype.internal_mouseOut=function(e){this.fireMouse("mouseOut",e);};protosx.prototype.internal_mouseDown=function(e){this.fireMouse("mouseDown",e);};protosx.prototype.internal_mouseMove=function(e){this.fireMouse("mouseMove",e);};protosx.prototype.internal_click=function(e){this.fireMouse("click",e);};protosx.prototype.internal_doubleClick=function(e){this.fireMouse("doubleClick",e);};protosx.prototype.getBounds=function(){var tl=protos.geom.localToGlobal(this,new protos.Point(0,0));var tr=protos.geom.localToGlobal(this,new protos.Point(this.width,0));var bl=protos.geom.localToGlobal(this,new protos.Point(0,this.height));var br=protos.geom.localToGlobal(this,new protos.Point(this.width,this.height));tl=protos.geom.globalToLocal(this.parent,tl);tr=protos.geom.globalToLocal(this.parent,tr);bl=protos.geom.globalToLocal(this.parent,bl);br=protos.geom.globalToLocal(this.parent,br);var minX=Math.min(tl.x,tr.x,bl.x,br.x);var maxX=Math.max(tl.x,tr.x,bl.x,br.x);var minY=Math.min(tl.y,tr.y,bl.y,br.y);var maxY=Math.max(tl.y,tr.y,bl.y,br.y);var rect=new protos.Rectangle();rect.x=minX;rect.y=minY;rect.width=maxX-minX;rect.height=maxY-minY;return rect;};protosx.uiTransform=function(ui){var trans="";if(navigator.userAgent.indexOf("WebKit")!=-1){trans+=" translate("+ui.x+"px,"+ui.y+"px) ";}trans+="rotate("+ui.rotation+"deg)";trans+=" scale("+ui.scaleX+","+ui.scaleY+")";var e=ui.element;var transOrigin="0% 0%";e.style.webkitTransformOrigin=transOrigin;e.style.msTransformOrigin=transOrigin;e.style.MozTransformOrigin=transOrigin;e.style.OTransformOrigin=transOrigin;e.style.transformOrigin=transOrigin;e.style.webkitTransform=trans;e.style.msTransform=trans;e.style.MozTransform=trans;e.style.OTransform=trans;e.style.transform=trans;};protosx.commitProperties=function(display){var e=display.element;e.style.position=display.position;e.style.pixelWidth=display.width;e.style.pixelHeight=display.height;if(navigator.userAgent.indexOf("WebKit")==-1){e.style.pixelLeft=display.x;e.style.pixelTop=display.y;}if(display.bgColor!=null){e.style.backgroundColor=display.bgColor;}if(navigator.appName!="Microsoft Internet Explorer"){if(navigator.userAgent.indexOf("WebKit")==-1){e.style.left=display.x+"px";e.style.top=display.y+"px";}e.style.width=display.width+"px";e.style.height=display.height+"px";if(display.alpha!=null){e.style.MozOpacity=display.alpha;e.style.opacity=display.alpha;}}else{if(display.alpha!=null){var iealpha="alpha( opacity=\"" + (display.alpha * 100)+ "\")";e.style.filter=iealpha;}}};protosx.retrieveElementProperties=function(display){var e=display.element;display.position=e.style.position;display.width=e.style.pixelWidth;display.height=e.style.pixelHeight;display.x=e.style.pixelLeft;display.y=e.style.pixelTop;display.bgColor=e.style.backgroundColor;if(navigator.appName!="Microsoft Internet Explorer"){display.x=e.style.left;display.y=e.style.top;display.width=e.style.width;display.height=e.style.height;if(e.style.MozOpacity){display.alpha=e.style.MozOpacity;}else{display.alpha=e.style.opacity;}}};protosx.addRoot=function(ui){if(ui.parent.className=="protos.display.Stage"){ui.stage=ui.parent;}else{ui.stage=ui.parent.stage;}var children=ui.children;if(children!=null){for(var i=0;i<children.length;i++){var child=children[i];protos.UIDisplay.addRoot(child);}}if(ui.stage!=null){ui.fire(new protos.Event(protos.Event.ADDED_TO_STAGE));}};protosx.removeRoot=function(ui){ui.stage=null;var children=ui.children;if(children!=null){for(i=0;i<children.length;i++){var child=children[i];protos.UIDisplay.removeRoot(child);}}if(ui.stage!=null){ui.fire(new protos.Event(protos.Event.REMOVE_TO_STAGE));}};protosx.prototype.setName=protosx.prototype.setId;protosx=null;
protos.MotionDisplay=function(){this.frames=[];this.currentFrame=1;this.totalFrames=1;this.listening=false;this.isPlaying=false;var p=protos.decodeUIArgument(arguments);protos.inherit(this,new protos.UIDisplay(p));this.className="protos.MotionDisplay";this.name=this.className+"_"+this.uid;this.setId(this.name);this.frames.push(this.children);this.super_addUI=this.addUI;this.addUI=this.md_addUI;this.super_removeUI=this.removeUI;this.removeUI=this.md_removeUI;delete this["md_addUI"];delete this["md_removeUI"];this.bind("addedToStage",this,"md_addedToStage");};protosx=protos.MotionDisplay;protosx.prototype.frames=null;protosx.prototype.currentFrame=0;protosx.prototype.totalFrames=0;protosx.prototype.super_addUI=null;protosx.prototype.super_removeUI=null;protosx.prototype.listening=false;protosx.prototype.isPlaying=false;protosx.prototype.md_addedToStage=function(event){if(this.stage!=null && this.listening==false){this.listening=true;this.stage.bind("frameUpdate",this,"md_updateFrame");}};protosx.prototype.md_addUI=function(ui){if(this.frames[this.currentFrame-1]==null){this.frames[this.currentFrame-1]=[];}this.children=this.frames[this.currentFrame-1];this.super_addUI(ui);};protosx.prototype.addUIAtFrame=function(ui,index){if(index==this.currentFrame){this.addUI(ui);}else{if(this.frames[index-1]==null){this.frames[index-1]=[];}var framec=this.frames[index-1 ];framec.push(ui);}};protosx.prototype.md_removeUI=function(ui){this.children=this.frames[this.currentFrame-1];this.super_removeUI(ui);};protosx.prototype.removeUIAtFrame=function(ui,index){};protosx.prototype.play=function(){this.isPlaying=true;};protosx.prototype.stop=function(){this.isPlaying=false;};protosx.prototype.md_updateFrame=function(event){if(this.isPlaying==true){this.currentFrame++;if(this.currentFrame>this.frames.length){this.currentFrame=1;}if(this.frames[this.currentFrame-1]!=null){this.children=this.frames[this.currentFrame-1];this.renderChildren();}this.fire(new protos.Event("frameUpdate"));}};
protos.UIBitmap=function(){if(arguments!=null){protos.inherit(this,new protos.UIDisplay(arguments[0]));}else{protos.inherit(this,new protos.UIDisplay());}this.className="protos.display.UIBitmap";this.setId(this.className+"_"+this.uid);};protosx=protos.UIBitmap;protosx.prototype.image=null;protosx.prototype.source=null;protosx.prototype.isDummy=false;protosx.prototype.useImageSize=true;protosx.prototype.blocker;protosx.prototype.load=function(src){this.source=src;this.image=new Image();this.image.style.position="absolute";this.image.onload=protos.delegate(this,"imgLoaded");this.image.src=this.source;this.image.__ui=this;};protosx.prototype.imgLoaded=function(){if(this.isDummy==false){this.element.appendChild(this.image);}if(this.useImageSize==true){this.width=this.image.width;this.height=this.image.height;}else{this.image.width=this.width;this.image.height=this.height;}this.blocker=new protos.UIDisplay({alpha:0,bgColor:"#FF0000",width:this.width,height:this.height});this.blocker.setId("bitblocker_"+this.uid);this.element.appendChild(this.blocker.element);this.redraw(false);this.fire(new protos.Event(protos.Event.COMPLETE));};protosx=null;
protos.Slice9Bitmap=function(){var args=arguments[0];protos.inherit(this,new protos.UIDisplay(args));this.slice9Guide=args.slice9Guide;this.className="protos.Slice9Bitmap";this.setId(this.className+"_"+this.uid);};protosx=protos.Slice9Bitmap;protosx.prototype.slice9Guide;protosx.prototype.bitmapSrc;protosx.prototype.slicer;protosx.prototype.bitmaps;protosx.prototype.outputBitmap=null;protosx.prototype.bitmapSliced=function(e){this.bitmaps=this.slicer.s9Bitmaps;this.slicer.unbind("complete",this,"bitmapSliced");this.redrawBitmap();};protosx.prototype.computeBitmapSize=function(){var tl={w:this.slice9Guide.left,h:this.slice9Guide.top};var tc={w:this.width-(this.slice9Guide.left+this.slice9Guide.right),h:this.slice9Guide.top,x:this.slice9Guide.left,y:0};var tr={w:this.slice9Guide.right,h:this.slice9Guide.top,x:tc.w+tl.w,y:0};var ml={w:this.slice9Guide.left,h:this.height-(this.slice9Guide.top+this.slice9Guide.bottom),x:0,y:this.slice9Guide.top};var mc={w:tc.w,h:ml.h,x:tc.x,y:ml.y};var mr={w:tr.w,h:ml.h,x:tr.x,y:ml.y};var bl={x:0,y:tl.h+ml.h,w:tl.w,h:this.slice9Guide.bottom};var bc={x:tc.x,y:bl.y,w:tc.w,h:bl.h};var br={x:tr.x,y:bl.y,w:tr.w,h:bl.h};return{tl:tl,tc:tc,tr:tr,ml:ml,mc:mc,mr:mr,bl:bl,bc:bc,br:br};};protosx.prototype.redrawBitmap=function(){var img;var s=this.computeBitmapSize();var cvs=document.createElement("canvas");var ctx=cvs.getContext("2d");cvs.width=this.width;cvs.height=this.height;img=this.bitmaps.slice_0.image;ctx.drawImage(img,0,0,s.tl.w,s.tl.h);img=this.bitmaps.slice_1.image;ctx.drawImage(img,s.tc.x,s.tc.y,s.tc.w,s.tc.h);img=this.bitmaps.slice_2.image;ctx.drawImage(img,s.tr.x,s.tr.y,s.tr.w,s.tr.h);img=this.bitmaps.slice_3.image;ctx.drawImage(img,s.ml.x,s.ml.y,s.ml.w,s.ml.h);img=this.bitmaps.slice_4.image;ctx.drawImage(img,s.mc.x,s.mc.y,s.mc.w,s.mc.h);img=this.bitmaps.slice_5.image;ctx.drawImage(img,s.mr.x,s.mr.y,s.mr.w,s.mr.h);img=this.bitmaps.slice_6.image;ctx.drawImage(img,s.bl.x,s.bl.y,s.bl.w,s.bl.h);img=this.bitmaps.slice_7.image;ctx.drawImage(img,s.bc.x,s.bc.y,s.bc.w,s.bc.h);img=this.bitmaps.slice_8.image;ctx.drawImage(img,s.br.x,s.br.y,s.br.w,s.br.h);var dataUrl=cvs.toDataURL("image/png");if(this.outputBitmap!=null){this.removeUI(this.outputBitmap);this.outputBitmap=null;}this.outputBitmap=new protos.UIBitmap({width:this.width,height:this.height});this.outputBitmap.load(dataUrl);this.addUI(this.outputBitmap);};protosx.prototype.redrawCallback=function(){this.redrawBitmap();};protosx.prototype.bitmapLoaded=function(e){this.bitmapSrc.unbind("complete",this,"bitmapLoaded");this.slicer=new protos.BitmapSlicer();this.slicer.bind("slice9Complete",this,"bitmapSliced");this.slicer.slice9(this.bitmapSrc,this.slice9Guide.left,this.bitmapSrc.width-this.slice9Guide.right,this.slice9Guide.top,this.bitmapSrc.height-this.slice9Guide.bottom);};protosx.prototype.load=function(src){this.bitmapSrc=new protos.UIBitmap();this.bitmapSrc.bind("complete",this,"bitmapLoaded");this.bitmapSrc.load(src);};
protos.UIText=function(){if(arguments){protos.inherit(this,new protos.UIDisplay(arguments[0]),["redraw"]);}else{protos.inherit(this,new protos.UIDisplay(),["redraw"]);}this.className="protos.display.UIText";this.name=this.className+"_"+this.uid;this.userSelect="text";this.selectable=true;this.tfhash=[];this.__cformats=[];this.__cspans=[];this.tfhash.push(new protos.TextFormat());this.editable=false;this.setId(this.name);this.configureKeyListeners();};protosx=protos.UIText;protosx.prototype.super_redraw=protos.UIDisplay.prototype.redraw;protosx.prototype.text="";protosx.prototype.selectable=true;protosx.prototype.editable=false;protosx.prototype.trimHTMLText=function(){var str=this.element.innerHTML;var openDivRE=/(<div)+([^>])*(>)+/gi;var openSpanRE=/(<span)+([^>])*(>)+/gi;var closeDivRE=/<[\/]div>/gi;var closeSpanRE=/<[\/]span>/gi;str=str.replace(openDivRE,"");str=str.replace(openSpanRE,"");str=str.replace(closeDivRE,"");str=str.replace(closeSpanRE,"");this.text=str;};protosx.prototype.internal_keyUp=function(e){this.fire(new protos.Event("keyUp"));this.trimHTMLText();this.fire(new protos.Event("change"));};protosx.prototype.internal_keyDown=function(e){this.fire(new protos.Event("keyDown"));};protosx.prototype.internal_keyPress=function(e){this.fire(new protos.Event("keyPress"));};protosx.prototype.setText=function(value){this.text=value;this.redraw();};protosx.prototype.setEditable=function(v){this.editable=v;this.redraw();};protosx.prototype.setSelectable=function(v){this.selectable=v;if(v==true){this.userSelect="text";}else{this.userSelect="none";}this.updateUserSelect();};protosx.prototype.setTextFormat=function(tf){this.tfhash.push(tf);this.redraw();};protosx.prototype.getFormatAt=function(index){for(var i=this.tfhash.length-1;i>=0;i--){var f=this.tfhash[i];var end=f.endIndex;if(end==-1){end=this.text.length-1;}if(index>=f.startIndex && index<=end){return f;}}return null;};protosx.prototype.redraw=function(){this.super_redraw(false);var align=this.tfhash[this.tfhash.length-1 ].align;var div="<div ";div+=" style=\"";div += "width:" +  this.width + "px;";div += "height:" +  this.height + "px;";div += "text-align:" +  align + ";";div += " \" ";div+="contentEditable=\"" + this.editable + "\" ";div+=">";var wf=protos.TextFormatUtil.addFormat(this);var ftxt=div+wf+"</div>";var nftxt=div+this.text+"</div>";this.element.innerHTML=ftxt;};
protos.UIControl=function(props){if(props==null){props={showContextMenu:true};}else{props.showContextMenu=true;}protos.inherit(this,new protos.UIDisplay(props),["redraw"]);this.className="protos.display.UIControl";this.element.type=this.controlType;};protosx=protos.UIControl;protosx.prototype.controlType="text";protosx.prototype.super_redraw=protos.UIDisplay.prototype.redraw;protosx.prototype.redraw=function(updateChildren){this.super_redraw(updateChildren);if(this.drawControl!=null){this.drawControl();}};protosx.prototype.registerUIEvents=function(list){var events=list;for(var i=0;i<events.length;i++){var method=events[i];var methodName="internal_on"+method;if(this[methodName]!=null){this.element["on"+method ]=protos.delegate(this,methodName);}}};protosx.prototype.uicFire=function(type,d){this.finalPreProcessEvent(type);this.fire(new protos.Event(type,true,true,d));};protosx.prototype.internal_onblur=function(){this.uicFire("blur");};protosx.prototype.internal_onchange=function(){if(this.className=="protos.display.UITextInput" || this.className=="protos.display.UITextArea"){this.text=this.element.value;}this.uicFire("change");};protosx.prototype.internal_onfocus=function(){this.uicFire("focus");};protosx.prototype.internal_onselect=function(){this.uicFire("select");};protosx.prototype.internal_onkeyup=function(e){if(this.className=="protos.display.UITextInput" || this.className=="protos.display.UITextArea"  || this.interfaces.indexOf("text")!=-1){this.text=this.element.value;}this.uicFire("keyUp",e);};protosx.prototype.internal_onkeydown=function(e){this.uicFire("keyDown",e);};protosx.prototype.internal_onkeypress=function(e){this.uicFire("keyPress",e);};
protos.UIButton=function(props,useDefaultState){var p=props;if(p==null){p={};}if(props.label!=null){this.label=props.label;}this.useDefaultState=useDefaultState;if(useDefaultState){p.tag="input";}protos.inherit(this,new protos.UIControl(p));this.className="protos.display.UIButton";this.setId(this.name);this.skin=props.skin;if(useDefaultState){this.controlType="button";this.element.type=this.controlType;}else{this.drawSkin();}this.redraw();this.configureMouseDelegation();};protosx=protos.UIButton;protosx.prototype.label="Button";protosx.prototype.skin=null;protosx.prototype.up=null;protosx.prototype.down=null;protosx.prototype.over=null;protosx.prototype.cover=null;protosx.prototype.useDefaultState=true;protosx.prototype.createSkin=function(){var skin=new protos.UIBitmap();skin.width=this.width;skin.height=this.height;skin.useImageSize=false;return skin;};protosx.prototype.drawSkin=function(){this.down=this.createSkin();this.down.load(this.skin.down);this.up=this.createSkin();this.up.load(this.skin.up);this.over=this.createSkin();this.over.load(this.skin.over);this.addUI(this.down);this.addUI(this.over);this.addUI(this.up);this.over.element.visibility="hidden";this.down.element.visibility="hidden";this.cover=this.createSkin();if(protos.Browser.type=="IE"){this.cover.bgColor="#000000";this.cover.isDummy=true;}this.cover.alpha=0;this.cover.load(this.skin.up);this.addUI(this.cover);this.bind("mouseUp",this,"uibMouseUp");this.bind("mouseDown",this,"uibMouseDown");this.bind("mouseOver",this,"uibMouseOver");this.bind("mouseOut",this,"uibMouseOut");this.uibMouseOut();};protosx.prototype.drawControl=function(){this.element.value=this.label;};protosx.prototype.hideChildren=function(){this.down.element.style.visibility="hidden";this.over.element.style.visibility="hidden";this.up.element.style.visibility="hidden";};protosx.prototype.setLabel=function(v){this.label=v;this.redraw(false);};protosx.prototype.uibMouseOver=function(){this.hideChildren();this.over.element.style.visibility="visible";};protosx.prototype.uibMouseOut=function(){this.hideChildren();this.up.element.style.visibility="visible";};protosx.prototype.uibMouseUp=function(){this.hideChildren();this.over.element.style.visibility="visible";};protosx.prototype.uibMouseDown=function(){this.hideChildren();this.down.element.style.visibility="visible";};
protos.UITextInput=function(){var arg=protos.decodeUIArgument(arguments);arg.tag="input";protos.inherit(this,new protos.UIControl(arg));this.controlType="text";if(arg.hideChars==true){this.controlType="password";}this.element.type=this.controlType;this.className="protos.display.UITextInput";this.name=this.className+"_"+this.uid;this.userSelect="text";this.setId(this.name);this.registerUIEvents(protos.Event.KEY_EVENTS);this.registerUIEvents(protos.Event.DATA_EVENTS);this.registerUIEvents(protos.Event.FOCUS_EVENTS);};protosx=protos.UITextInput;protosx.prototype.text="";protosx.prototype.setText=function(value){this.text=value;this.redraw(false);};protosx.prototype.drawControl=function(){this.element.value=this.text;};
protos.UITextArea=function(){var arg=protos.decodeUIArgument(arguments);arg.tag="textarea";this.tfhash=[];this.tfhash.push(new protos.TextFormat());if(arg.resize==null){this.resize="none";}else{this.resize=arg.resize;}protos.inherit(this,new protos.UIControl(arg));this.className="protos.display.UITextArea";this.name=this.className+"_"+this.uid;this.userSelect="text";this.setId(this.name);this.element.style.resize=this.resize;this.registerUIEvents(protos.Event.KEY_EVENTS);this.registerUIEvents(protos.Event.DATA_EVENTS);this.registerUIEvents(protos.Event.FOCUS_EVENTS);};protosx=protos.UITextArea;protosx.prototype.text="";protosx.prototype.columns=-1;protosx.prototype.rows=-1;protosx.prototype.resize="none";protosx.prototype.tfhash=null;protosx.prototype.setText=function(value){this.text=value;this.redraw(false);};protosx.prototype.setDimension=function(cols,rows){this.columns=cols;this.rows=rows;this.redraw(false);};protosx.prototype.preProcessEvent=function(type){if(type=="keyUp" || type=="change"){this.trimHTMLText();}};protosx.prototype.drawControl=function(){this.element.value=this.text;if(this.columns!=-1){this.element.setAttribute("cols",this.columns);}if(this.rows!=-1){this.element.setAttribute("rows",this.rows);}if(this.resize!=null){this.element.style.resize=this.resize;}};protosx.prototype.trimHTMLText=function(){var str=this.element.value;var openDivRE=/(<div)+([^>])*(>)+/gi;var openSpanRE=/(<span)+([^>])*(>)+/gi;var closeDivRE=/<[\/]div>/gi;var closeSpanRE=/<[\/]span>/gi;str=str.replace(openDivRE,"");str=str.replace(openSpanRE,"");str=str.replace(closeDivRE,"");str=str.replace(closeSpanRE,"");this.text=str;};protosx.prototype.setTextFormat=function(tf){this.tfhash.push(tf);this.redraw(false);};protosx.prototype.getFormatAt=function(index){for(var i=this.tfhash.length-1;i>=0;i--){var f=this.tfhash[i];var end=f.endIndex;if(end==-1){end=this.text.length-1;}if(index>=f.startIndex && index<=end){return f;}}return null;}

protos.UIDropdown=function(){var arg=protos.decodeUIArgument(arguments);arg.tag="select";protos.inherit(this,new protos.UIControl(arg));this.className="protos.display.UIDropDown";this.name=this.className+"_"+this.uid;this.setId(this.name);this.registerUIEvents(protos.Event.KEY_EVENTS);this.registerUIEvents(protos.Event.DATA_EVENTS);this.registerUIEvents(protos.Event.FOCUS_EVENTS);};protosx=protos.UIDropdown;protosx.prototype.dataProvider=null;protosx.prototype.labelField="label";protosx.prototype.selectedIndex=0;protosx.prototype.selectedItem=null;protosx.prototype.setDataProvider=function(arr){this.dataProvider=arr;this.drawControl();};protosx.prototype.drawControl=function(){this.element.innerHTML="";var options="";for(var i=0;i<this.dataProvider.length;i++){var o=this.dataProvider[i];if(o.selected==true){this.selectedIndex=i;options+="<option value=\"" + i + "\" selected=\"selected\"   >"+o[this.labelField]+"</option>";}else{options+="<option value=\"" + i + "\" >"+o[this.labelField]+"</option>";}}this.element.innerHTML=options;};protosx.prototype.preProcessEvent=function(type){if(type=="change"){this.selectedIndex=parseInt(this.element.value);this.selectedItem=this.dataProvider[this.selectedIndex ];}};
protos.UICheckBox=function(){var arg=protos.decodeUIArgument(arguments);arg.tag="input";protos.inherit(this,new protos.UIControl(arg));if(arg.group!=null){this.group=arg.group;}this.controlType="checkbox";this.element.type=this.controlType;this.className="protos.display.UICheckBox";this.name=this.className+"_"+this.uid;this.userSelect="text";this.setId(this.name);this.element.name=this.group;this.positionControl();this.registerUIEvents(protos.Event.KEY_EVENTS);this.registerUIEvents(protos.Event.DATA_EVENTS);this.registerUIEvents(protos.Event.FOCUS_EVENTS);};protosx=protos.UICheckBox;protosx.prototype.group=null;protosx.prototype.positionControl=function(){if(navigator.userAgent.indexOf("WebKit")!=-1 || navigator.appName.indexOf("Microsoft")!=-1){this.element.style.marginLeft=1;this.element.style.marginTop=1;}else{this.element.style.marginLeft=0;this.element.style.marginTop=0;}};protosx.prototype.setGroup=function(g){this.group=g;this.redraw(false);};protosx.prototype.drawControl=function(){this.element.name=this.group;this.positionControl();};protosx.prototype.preProcessEvent=function(type){if(type=="click"){}};protosx.prototype.isSelected=function(){return this.element.checked;};protosx.prototype.setSelected=function(v){this.element.checked=v;};
protos.UIRadioButton=function(){var arg=protos.decodeUIArgument(arguments);arg.tag="input";protos.inherit(this,new protos.UIControl(arg));if(arg.group!=null){this.group=arg.group;}this.controlType="radio";this.element.type=this.controlType;this.className="protos.display.UIRadioButton";this.name=this.className+"_"+this.uid;this.userSelect="text";this.setId(this.name);this.positionControl();this.element.name=this.group;this.registerUIEvents(protos.Event.KEY_EVENTS);this.registerUIEvents(protos.Event.DATA_EVENTS);this.registerUIEvents(protos.Event.FOCUS_EVENTS);};protosx=protos.UIRadioButton;protosx.prototype.group=null;protosx.prototype.positionControl=function(){if(navigator.userAgent.indexOf("WebKit")!=-1 || navigator.appName.indexOf("Microsoft")!=-1){this.element.style.marginLeft=1;this.element.style.marginTop=1;}else{this.element.style.marginLeft=0;this.element.style.marginTop=0;}};protosx.prototype.setGroup=function(g){this.group=g;this.redraw(false);};protosx.prototype.drawControl=function(){this.element.name=this.group;this.positionControl();};protosx.prototype.preProcessEvent=function(type){if(type=="click"){}};protosx.prototype.isSelected=function(){return this.element.checked;};protosx.prototype.setSelected=function(v){this.element.checked=v;};
protos.Stage=function(id,width,height,stageColor,stageAlpha,frameRate,useOffset){var stageParent=document.getElementById(id);var sprops={};sprops.width=width;sprops.height=height;sprops.position="relative";protos.inherit(this,new protos.UIDisplay(sprops));protos.Browser.update();stageParent.appendChild(this.element);this.useOffset=useOffset;if(frameRate==null){this.frameRate=50;}else{this.frameRate=frameRate;}if(this.frameRate>100){this.frameRate=100;}this.updateInterval=1000/this.frameRate;this.uintCtr=0;if(this.width==null){if(this.useOffset==true){this.width=protos.Browser.width-protos.Browser.widthOffset;}else{this.width=protos.Browser.width;}this.useBrowserWidth=true;}if(this.height==null){this.useBrowserHeight=true;if(this.useOffset==true){this.height=protos.Browser.height-protos.Browser.heightOffset;}else{this.height=protos.Browser.height;}}this.className="protos.display.Stage";this.name=this.className+"_"+this.uid;this.alpha=1.0;this.bgColor=null;if(stageColor!=null){this.stageBGColor=stageColor;}if(stageAlpha!=null){this.stageBGAlpha=stageAlpha;}this.mouseLayer=new protos.UIDisplay({alpha:this.stageBGAlpha,width:this.width,height:this.height,bgColor:this.stageBGColor});this.mouseLayer.name="stageMouseLayer";this.mouseLayer.setId("mouseLayer_"+this.mouseLayer.uid);this.redraw(false);this.addUI(this.mouseLayer);this.mouseMoveEnabled=true;this.setId(this.name);protos.uistage[this.id]=this;this.stage=this;this.bind("mouseMove",this,"stage_mouseMove");this.dragTarget=null;this.dragStart=null;this.dragTStart=null;this.dragChange=null;};protosx=protos.Stage;protosx.prototype.useBrowserWidth=false;protosx.prototype.useBrowserHeight=false;protosx.prototype.mouseLayer;protosx.prototype.stageBGColor="#000000";protosx.prototype.stageBGAlpha=1;protosx.prototype.frameRate=30;protosx.prototype.updateInterval=-1;protosx.prototype.uintCtr=0;protosx.prototype.dragTarget=null;protosx.prototype.dragStart=null;protosx.prototype.dragTStart=null;protosx.prototype.dragChange=null;protosx.prototype.dragBounds=null;protosx.prototype.mouseTarget=null;protosx.getMouseXY=function(e){var p=new protos.Point();if(!e)var e=window.event;if(e.pageX || e.pageY){p.x=e.pageX;p.y=e.pageY;}else if(e.clientX || e.clientY){p.x=e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft;p.y=e.clientY+document.body.scrollTop+document.documentElement.scrollTop;}return p;};protosx.prototype.isBoundXValid=function(target,source){if(source==null){return{res:true};}if(target.x<source.x){return{res:false,hit:"l"};}else if(target.x+target.width>=source.width){return{res:false,hit:"r"};}return{res:true};};protosx.prototype.isBoundYValid=function(target,source){if(source==null){return{res:true};}if(target.y<source.y){return{res:false,hit:"t"};}else if(target.y+target.height>=source.height){return{res:false,hit:"b"};}return{res:true};};protosx.prototype.stage_mouseMove=function(event){var t=event.data.currentTarget;var mp=protos.Stage.getMouseXY(event.data);this.mouseX=mp.x-parseFloat(this.element.offsetLeft);this.mouseY=mp.y-parseFloat(this.element.offsetTop);var mui=protos.geom.globalToLocal(t.__ui,new protos.Point(this.mouseX,this.mouseY));t.__ui.mouseX=mui.x;t.__ui.mouseY=mui.y;if(this.dragStart!=null && this.dragTStart!=null && this.dragTarget!=null){this.dragChange=new protos.Point(0,0);this.dragChange.x=this.mouseX-this.dragStart.x;this.dragChange.y=this.mouseY-this.dragStart.y;var nx=this.dragTStart.x+this.dragChange.x;var ny=this.dragTStart.y+this.dragChange.y;var cx=this.dragTarget.x;var cy=this.dragTarget.y;var preBounds=this.dragTarget.getBounds();this.dragTarget.x=nx;this.dragTarget.y=ny;var b=this.dragTarget.getBounds();var bx=this.isBoundXValid(b,this.dragBounds);if(this.dragBounds!=null &&  bx.res==false){nx=cx;if(bx.hit=="l"){nx=cx-(preBounds.x-this.dragBounds.x);}else{nx=cx+(this.dragBounds.width-(preBounds.x+preBounds.width));}}var by=this.isBoundYValid(b,this.dragBounds);if(this.dragBounds!=null &&  by.res==false){ny=cy;if(by.hit=="t"){ny=cy-(preBounds.y-this.dragBounds.y);}else{ny=cy+(this.dragBounds.height-(preBounds.y+preBounds.height));}}this.dragTarget.transform({x:nx,y:ny});}};protosx.prototype.update=function(){protos.Browser.update();if(this.useBrowserWidth){if(this.useOffset==true){this.width=protos.Browser.width-protos.Browser.widthOffset;}else{this.width=protos.Browser.width;}this.mouseLayer.width=this.width;}if(this.useBrowserHeight){if(this.useOffset==true){this.height=protos.Browser.height-protos.Browser.heightOffset;}else{this.height=protos.Browser.height;}this.mouseLayer.height=this.height;}this.redraw(false);this.mouseLayer.redraw(false);this.fire(new protos.Event(protos.Event.RESIZE));};protosx.prototype.frameUpdate=function(){this.fire(new protos.Event(protos.Event.FRAME_UPDATE));};
protos.TextFormat=function(){this.fontSize=12;this.fontFamily="Arial";this.fontStyle="normal";this.fontWeight="normal";this.lineHeight="normal";this.letterSpacing=0;this.leading=0;this.color="#000000";this.strokeColor="#000000";this.fillAlpha=1;this.strokeAlpha=1;this.stroke=false;this.align="left";this.startIndex=0;this.endIndex=-1;if(arguments[0]!=null){var params=arguments[0];for(var i in  params){this[i]=params[i];}}protos.TextFormat.count++;this.tfid=protos.TextFormat.count;};protosx=protos.TextFormat;protosx.prototype.fontSize=12;protosx.prototype.fontFamily="Arial";protosx.prototype.fontWeight=null;protosx.prototype.fontStyle=null;protosx.prototype.color="#000000";protosx.prototype.lineHeight=1;protosx.prototype.letterSpacing=0;protosx.prototype.leading=0;protosx.prototype.strokeColor="#000000";protosx.prototype.fillAlpha=1;protosx.prototype.strokeAlpha=1;protosx.prototype.stroke=false;protosx.prototype.align="left";protosx.prototype.startIndex=0;protosx.prototype.endIndex=-1;protosx.prototype.tfid=0;protosx.count=0;
protos.TextFormatUtil=function(){};protosx=protos.TextFormatUtil;protosx.addFormat=function(ui){var ntext="";var cspan="";var closer=protos.TextFormatUtil.closeSpan(ctf);var ctf=null;for(var i=0;i<ui.text.length;i++){var f=ui.getFormatAt(i);if(f!=null){if(ctf==null){ctf=f;cspan=protos.TextFormatUtil.openSpan(ctf);ntext+=cspan+ui.text.charAt(i);}else if(ctf.tfid==f.tfid){ntext+=ui.text.charAt(i);}else if(ctf.tfid!=f.tfid){ntext+=closer;ctf=f;cspan=protos.TextFormatUtil.openSpan(ctf);ntext+=cspan+ui.text.charAt(i);}if(i==ui.text.length-1){ntext+=closer;}}}return ntext;};protosx.openSpan=function(tf){var span="<span style=\" "; span += " color:" + tf.color + ";";  if( tf.fontFamily != null ) {span += "font-family:" + tf.fontFamily + ";";} if( tf.fontSize != null ) {span += "font-size:" + tf.fontSize +  ";";}if( tf.fontStyle != null ) {span += "font-style:" + tf.fontStyle  +  ";";} if( tf.fontWeight != null ) {span += "font-weight:" + tf.fontWeight  + ";";} if( tf.lineHeight != null ) {span += "line-height:" + tf.lineHeight  + ";";}if( tf.letterSpacing != null ) {span += "letter-spacing:" + tf.letterSpacing  + ";";}span += "\"  >";return span;};protosx.closeSpan=function(){return "</span>";};
protos.SortUtil=function(){};protosx=protos.SortUtil;protosx.swap=function(array,index1,index2){var tmp=array[index1];array[index1]=array[index2 ];array[index2 ]=tmp;};protosx.partition=function(array,start,end,pivotIndex,propertyName){var pivot=array[pivotIndex];protos.SortUtil.swap(array,pivotIndex,(end-1));var store=start;for(var i=start;i<end-1;++i){if(propertyName!=null){if(array[i][propertyName]<=pivot[propertyName]){protos.SortUtil.swap(array,store,i);++store;}}else{if(array[i]<=pivot){protos.SortUtil.swap(array,store,i);++store;}}}protos.SortUtil.swap(array,end-1,store);return store;};protosx.qsort=function(array,start,end,propertyName){if(end-1>start){var pivotIndex=start+Math.floor(Math.random()*(end-start));pivotIndex=protos.SortUtil.partition(array,start,end,pivotIndex,propertyName);protos.SortUtil.qsort(array,start,pivotIndex,propertyName);protos.SortUtil.qsort(array,pivotIndex+1,end,propertyName);}};protosx.quickSort=function(array,propertyName){protos.SortUtil.qsort(array,0,array.length,propertyName);};
protos.NumberUtil=function(){};protosx=protos.NumberUtil;protosx.toRadian=function(degrees){return degrees*(Math.PI/180);};protosx.toDegrees=function(radian){return  radian*(180/Math.PI);};protosx.hexTodecimal=function(hex){return parseInt(hex,16);};protosx.decToHex=function(dec){var hex=dec.toString(16);if(hex.length==1){hex="0"+hex;}return hex;};protosx.toRGB=function(color){var col=color;if(col.substring(0,1)=="#"){col=col.slice(1);}while(col.length<6){col=col+"0";}var o={};o.r=protos.NumberUtil.hexTodecimal(col.substring(0,2));o.g=protos.NumberUtil.hexTodecimal(col.substring(2,4));o.b=protos.NumberUtil.hexTodecimal(col.substring(4,6));return o;};protosx.randomRange=function(min,max){var ran=Math.round(Math.random()*(max-min))+min;return ran;};protosx.random=function(value){var ran=Math.round(Math.random()*value);return ran;};
protos.Cookie=function(){};protosx=protos.Cookie;protosx.data={};protosx.createCookie=function(name,value){var name=cookieName+"="+escape(value)+"";var path="path=/";document.cookie=name+"; "+path;};protosx.insert=function(name,value){this.data[name ]=value;var newVP;newVP=name+"="+escape(value);document.cookie=newVP+"; path=/";};protosx.initCookies=function(){var dcookie=unescape(document.cookie);if(dcookie.indexOf("=")!=-1){var cookieArray=dcookie.split("; ");for(var i=0;i<cookieArray.length;i++){var valuePairString=cookieArray[i];if(valuePairString.indexOf("=")!=-1){var valuePair=valuePairString.split("=");var cname=valuePair[0];var cvalue=valuePair[1];protos.Cookie.data[cname]=cvalue;}}}};protosx.getCookieByName=function(name){return{name:name,value:this.data[name]};};protosx.initCookies();
protos.net={};protos.net.NetRequest=function(){protos.inherit(this,new protos.EventDispatcher());this.isIE8=false;this.useCrossDomainIE=false;if(typeof  window.XDomainRequest!="undefined"){this.isIE8=true;}this.className="protos.net.NetRequest";this.request=null;};protosx=protos.net.NetRequest;protosx.prototype.isIE8=false;protosx.prototype.nonIE=true;protosx.prototype.request=null;protosx.prototype.useCrossDomainIE=false;protosx.prototype.createRequest=function(){if(this.isIE8){this.nonIE=false;if(this.useCrossDomainIE){return new window.XDomainRequest();}else{return new XMLHttpRequest();}}if(typeof XMLHttpRequest=="undefined"){this.nonIE=false;try{return new ActiveXObject("Msxml2.XMLHTTP.6.0");}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0");}catch(e){}try{return new ActiveXObject("Microsoft.XMLHTTP");}catch(e){}throw new Error("This browser does not support XMLHttpRequest.");return;}this.nonIE=true;return new XMLHttpRequest();};protosx.prototype.load=function(url,method,data){this.request=this.createRequest();var dmethod=method;if(this.isIE8 && this.useCrossDomainIE){this.request.onload=protos.delegate(this,"ieOnLoad");this.request.onerror=protos.delegate(this,"ieOnError");this.request.onprogress=protos.delegate(this,"ieOnProgress");this.request.ontimeout=protos.delegate(this,"ieOnTimeout");dmethod="GET";}else{this.request.onreadystatechange=protos.delegate(this,"readyStateNonIE");}var newURL=url;var params=protos.urlEncode(data);if(dmethod.toUpperCase()=="GET"){if(params!="")newURL+="?"+encodeURI(params);this.request.open(method,newURL,true);this.request.send(null);}else{this.request.open(method,newURL,true);if(this.request.setRequestHeader!=null){this.request.setRequestHeader("Content-type","application/x-www-form-urlencoded");}this.request.send(params);}};protosx.prototype.ieOnProgress=function(){console.log("ON PRogress");};protosx.prototype.ieOnError=function(){console.log("ON Error "+this.request.readyState);};protosx.prototype.ieOnTimeout=function(){console.log("ON Timeout ");};protosx.prototype.ieOnLoad=function(){this.data=this.request.responseText;this.fire(new protos.Event(protos.Event.COMPLETE));};protosx.prototype.readyStateNonIE=function(){if(this.request.readyState==4 && this.request.status==200){this.data=this.request.responseText;this.fire(new protos.Event(protos.Event.COMPLETE));}};
protos.net.SourceLoader=function(){protos.inherit(this,new protos.EventDispatcher());};protosx=protos.net.SourceLoader;protosx.prototype.nr;protosx.prototype.load=function(src){this.nr=new protos.net.NetRequest();this.nr.bind("complete",this,"sourceLoaded");this.nr.load(src,"post");};protosx.prototype.sourceLoaded=function(e){this.appendSource(this.nr.data);this.nr.unbind("complete",this,"sourceLoaded");this.nr=null;this.fire(new protos.Event("complete"));};protosx.prototype.sourceList;protosx.prototype.srcIndex=0;protosx.prototype.sourceStr;protosx.prototype.loadSourceList=function(a){if(this.nr!=null){this.nr.unbind("complete",this,"nextSourceLoaded");this.nr=null;}this.sourceList=a;this.srcIndex=0;this.sourceStr="";this.loadNext();};protosx.prototype.loadNext=function(){if(this.nr!=null){this.nr.unbind("complete",this,"nextSourceLoaded");this.nr=null;}if(this.srcIndex<this.sourceList.length){this.nr=new protos.net.NetRequest();this.nr.bind("complete",this,"nextSourceLoaded");this.nr.load(this.sourceList[this.srcIndex],"post");}else{if(this.sourceStr!=""){this.appendSource(this.sourceStr);}this.fire(new protos.Event("complete"));}};protosx.prototype.appendSource=function(src){var h=document.getElementsByTagName("head")[0];var s=document.createElement("script");s.type="text/javascript";s.innerHTML=src;h.appendChild(s);};protosx.prototype.nextSourceLoaded=function(e){this.srcIndex++;this.sourceStr+=this.nr.data+"\n\n";this.loadNext();};
protos.Timer=function(msec,loop){protos.inherit(this,new protos.EventDispatcher());protos.Timer.count++;if(loop!=null)this.loop=loop;this.index=protos.Timer.count;protos.Timer.timers["t_"+this.index ]=this;this.msec=msec;};protosx=protos.Timer;protosx.count=0;protosx.prototype.index=-1;protosx.prototype.msec=-1;protosx.prototype.current=0;protosx.prototype.loop=-1;protosx.prototype.loopCtr=0;protosx.prototype.update=function(){if(this.msec!=-1){this.current+=protos.System.timeout;if(this.current>=this.msec){this.current=0;this.loopCtr+=1;this.fire(new protos.Event("timer"));if(this.loop!=-1 &&  this.loopCtr>=this.loop){this.stop();this.fire(new protos.Event("timerFinish"));}}}};protosx.prototype.start=function(){this.v=this.update;};protosx.prototype.stop=function(){this.v=null;delete protos.Timer.timers["t_"+this.index ];};protosx.prototype.v=null;protosx.timers={};protosx.timerCount=0;protosx.intervalUpdate=function(){if(protos.System!=null){protos.System.update();}var timers=protos.Timer.timers;for(var i in timers){var t=timers[i];if(t!=null  &&  t.v!=null){t.v();}}};protosx.intervalId=setInterval("protos.Timer.intervalUpdate()",protos.System.timeout);
protos.AssetsProxy=function(){protos.inherit(this,new protos.EventDispatcher());this.hash={};this.loadedIndex=0;this.progressRatio=0;};protosx=protos.AssetsProxy;protosx.prototype.hash=null;protosx.prototype.notLoadedList=null;protosx.prototype.loadedIndex=-1;protosx.prototype.progressRatio=0;protosx.prototype.load=function(objlist){this.notLoadedList=objlist;this.loadedIndex=0;this.next();};protosx.prototype.next=function(){var nloaded=this.notLoadedList[this.loadedIndex ];var bit=new protos.UIBitmap();this.hash[nloaded.name ]=bit;this["asset_"+nloaded.name ]=bit;bit.bind("complete",this,"currentLoaded");bit.setId(nloaded.name);bit.load(nloaded.url);};protosx.prototype.getAsset=function(aname){return this.hash[aname];};protosx.prototype.currentLoaded=function(event){this.loadedIndex++;if(this.loadedIndex<this.notLoadedList.length){this.progressRatio=Math.round((this.loadedIndex/this.notLoadedList.length)*100);this.fire(new protos.Event("progress"));this.next();}else{this.progressRatio=100;this.fire(new protos.Event("complete"));}};
protos.BitmapSlicer=function(){protos.inherit(this,new protos.EventDispatcher());this.bitmaps=null;this.urls=null;};protosx=protos.BitmapSlicer;protosx.prototype.bitmaps=null;protosx.prototype.urls=null;protosx.prototype.proxy=null;protosx.prototype.slice=function(bit,sw,sh,skipLoad){var canvas=document.createElement("canvas");canvas.width=sw;canvas.height=sh;var ctx=canvas.getContext("2d");this.urls=[];var wlen=bit.width/sw;var hlen=bit.height/sh;ctx.clearRect(0,0,sw,sh);var image=bit.image;for(var y=0;y<hlen;y++){for(var x=0;x<wlen;x++){ctx.save();var px=sw*x;var py=sh*y;ctx.clearRect(0,0,sw,sh);if(px!=0)px*=-1;if(py!=0)py*=-1;ctx.translate(px,py);ctx.drawImage(image,0,0);this.urls.push({name:"slice_"+this.urls.length,url:canvas.toDataURL("image/png")});ctx.restore();}}if(skipLoad!=true){this.proxy=new protos.AssetsProxy();this.proxy.bind("complete",this,"proxyComplete");this.proxy.load(this.urls);}};protosx.prototype.proxyComplete=function(event){this.bitmaps=this.proxy.hash;this.fire(new protos.Event("complete"));};protosx.prototype.s9Proxy=null;protosx.prototype.s9URLS=null;protosx.prototype.s9Bitmaps=null;protosx.prototype.getSlice9URL=function(x,y,w,h,img){var canvas=document.createElement("canvas");var ctx=canvas.getContext("2d");var url="";canvas.width=w;canvas.height=h;ctx.save();ctx.clearRect(0,0,w,h);ctx.translate(x*-1,y*-1);ctx.drawImage(img,0,0);url=canvas.toDataURL("image/png");ctx.restore();return url;};protosx.prototype.slice9Complete=function(event){this.s9Bitmaps=this.s9Proxy.hash;this.fire(new protos.Event("slice9Complete"));};protosx.prototype.slice9=function(btmp,minX,maxX,minY,maxY){if(minX==null || minX<=0)return;if(minY==null ||  minY<=0)return;if(maxX==null || maxX>=btmp.width)return;if(maxY==null || maxY>=btmp.height)return;this.slice9URLS=[];var lx=0;var lw=minX;var mx=minX;var mw=maxX-minX;var rx=mx+mw;var rw=btmp.width-maxX;var ty=0;var th=minY;var my=minY;var mh=maxY-minY;var by=my+mh;var bh=btmp.height-maxY;var img=btmp.image;this.s9URLS=[];this.s9URLS.push({name:"slice_0",url:this.getSlice9URL(lx,ty,lw,th,img)});this.s9URLS.push({name:"slice_1",url:this.getSlice9URL(mx,ty,mw,th,img)});this.s9URLS.push({name:"slice_2",url:this.getSlice9URL(rx,ty,rw,th,img)});this.s9URLS.push({name:"slice_3",url:this.getSlice9URL(lx,my,lw,mh,img)});this.s9URLS.push({name:"slice_4",url:this.getSlice9URL(mx,my,mw,mh,img)});this.s9URLS.push({name:"slice_5",url:this.getSlice9URL(rx,my,rw,mh,img)});this.s9URLS.push({name:"slice_6",url:this.getSlice9URL(lx,by,lw,bh,img)});this.s9URLS.push({name:"slice_7",url:this.getSlice9URL(mx,by,mw,bh,img)});this.s9URLS.push({name:"slice_8",url:this.getSlice9URL(rx,by,rw,bh,img)});this.s9Proxy=new protos.AssetsProxy();this.s9Proxy.bind("complete",this,"slice9Complete");this.s9Proxy.load(this.s9URLS);};protosx.cloneBitmap=function(bit){var canvas=document.createElement("canvas");canvas.width=bit.width;canvas.height=bit.height;var ctx=canvas.getContext("2d");ctx.clearRect(0,0,bit.width,bit.height);;ctx.drawImage(bit.image,0,0);var bitmap=new protos.UIBitmap();bitmap.load(canvas.toDataURL("image/png"));return bitmap;};
protos.Animation=function(target,propsFrom,propsTo,duration,easingFuncs,useTimer){protos.inherit(this,new protos.EventDispatcher());this.useTimer=useTimer;this.target=target;this.propsFrom=propsFrom;this.propsTo=propsTo;this.duration=duration;this.easingFuncs=easingFuncs;this.c={};this.t=0;for(var i in propsFrom){if(propsTo[i]!=null){this.c[i]=propsTo[i]-propsFrom[i];}}};protosx=protos.Animation;protosx.prototype.target=null;protosx.prototype.propsFrom=null;protosx.prototype.propsTo=null;protosx.prototype.duration=null;protosx.prototype.useTimer=null;protosx.prototype.easingFuncs=null;protosx.prototype.c=null;protosx.prototype.t=-1;protosx.prototype.timer=null;protosx.prototype.play=function(){this.t=0;this.timer=new protos.Timer(protos.Animation.timeout);this.timer.bind("timer",this,"executeMotionInTime");this.timer.start();};protosx.prototype.stop=function(){this.timer.stop();this.timer.unbind("timer",this,"executeMotionInTime");};protosx.prototype.executeMotionInTime=function(event){if(this.t>this.duration){this.stop();if(this.easingFuncs!=null){for(var i in this.c){this.target[i]=this.easingFuncs[i](this.duration,this.propsFrom[i],this.c[i],this.duration);}this.target.redraw(false);}this.dispatchEvent(new protos.Event("motionFinish",this,null,false));return;}if(this.easingFuncs!=null){for(var i in this.c){this.target[i]=this.easingFuncs[i](this.t,this.propsFrom[i],this.c[i],this.duration);}this.target.redraw(false);}this.t+=protos.Animation.timeout;};protosx.prototype.executeMotionInFrame=function(event){if(this.t>this.duration){this.stop();this.dispatchEvent(new protos.Event("motionFinish",this,null,false));return;}if(this.easingFuncs!=null){for(var i in this.c){this.target[i]=this.easingFuncs[i](this.t,this.propsFrom[i],this.c[i],this.duration);}this.target.redraw(false);}this.t++;};protosx.timeout=10;
protos.Easing=function(){};protosx=protos.Easing;protosx.linear=function(t,b,c,d){return c*t/d+b;};protosx.normalIn=function(t,b,c,d){var nt=t/d;return c*(nt*nt)+b;};protosx.normalOut=function(t,b,c,d){var nt=t/d;return-c*nt*(nt-2)+b;};protosx.normalInOut=function(t,b,c,d){var nt=t/(d/2);if(nt<1)return(c/2)*nt*nt+b;return(-c/2)*((--nt)*(nt-2)-1)+b;};protosx.cubicIn=function(t,b,c,d){var nt=t/d;return c*Math.pow(nt,3)+b;};protosx.cubicOut=function(t,b,c,d){var nt=t/d-1;return c*(Math.pow(nt,3)+1)+b;};protosx.cubicInOut=function(t,b,c,d){var nt=t/(d/2);if(nt<1){return c/2*Math.pow(nt,3)+b;}return c/2*(Math.pow(nt-2,3)+2)+b;};protosx.bounceOut=function(t,b,c,d){if((t/=d)<(1/2.75)){return c*(7.5625*t*t)+b;}else if(t<(2/2.75)){return c*(7.5625*(t-=(1.5/2.75))*t+0.75)+b;}else if(t<(2.5/2.75)){return c*(7.5625*(t-=(2.25/2.75))*t+0.9375)+b;}else{return c*(7.5625*(t-=(2.625/2.75))*t+0.984375)+b;}};protosx.bounceIn=function(t,b,c,d){return c-protos.Easing.bounceOut(d-t,0,c,d)+b;};protosx.bounceInOut=function(t,b,c,d){if(t<d/2){return protos.Easing.bounceIn(t*2,0,c,d)*0.5+b;}else{return protos.Easing.bounceOut(t*2-d,0,c,d)*0.5+c*0.5+b;}};protosx.quarticIn=function(t,b,c,d){var nt=t/d;return c*Math.pow(nt,4)+b;};protosx.quarticOut=function(t,b,c,d){var nt=t/d;return-c*(Math.pow(nt-1,4)-1)+b;};protosx.quarticInOut=function(t,b,c,d){var nt=t/(d/2);if(nt<1){return c/2*Math.pow(nt,4)+b;}return-c/2*(Math.pow(nt-2,4)-2)+b;};protosx.strongIn=function(t,b,c,d){return c*(t/=d)*t*t*t*t+b;};protosx.strongOut=function(t,b,c,d){return c*((t=t/d-1)*t*t*t*t+1)+b;};protosx.strongInOut=function(t,b,c,d){if((t/=d/2)<1)return c/2*t*t*t*t*t+b;return c/2*((t-=2)*t*t*t*t+2)+b;};protosx.backIn=function(t,b,c,d,s){if(s==null || s==0){s=1.70158;}return c*(t/=d)*t*((s+1)*t-s)+b;};protosx.backOut=function(t,b,c,d,s){if(s==null || s==0){s=1.70158;}return c*((t=t/d-1)*t*((s+1)*t+s)+1)+b;};protosx.backInOut=function(t,b,c,d,s){if(s==null || s==0){s=1.70158;}if((t/=d/2)<1){return c/2*(t*t*(((s*=(1.525))+1)*t-s))+b;}return c/2*((t-=2)*t*(((s*=(1.525))+1)*t+s)+2)+b;};protosx.elasticIn=function(t,b,c,d,a,p){if(t==0){return b;}if((t/=d)==1){return b+c;}if(p==null || p==0){p=d*0.3;}var s;if(a==null || a<Math.abs(c)){a=c;s=p/4;}else{s=p/(2*Math.PI)*Math.asin(c/a);}return-(a*Math.pow(2,10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p))+b;};protosx.elasticOut=function(t,b,c,d,a,p){if(t==0){return b;}if((t/=d)==1){return b+c;}if(p==null ||  p==0){p=d*0.3;}var s;if(!a || a<Math.abs(c)){a=c;s=p/4;}else{s=p/(2*Math.PI)*Math.asin(c/a);}return a*Math.pow(2,-10*t)*Math.sin((t*d-s)*(2*Math.PI)/p)+c+b;};protosx.elasticInOut=function(t,b,c,d,a,p){if(t==0){return b;}if((t/=d/2)==2){return b+c;}if(p==null ||  p==0){p=d*(0.3*1.5);}var s;if(!a || a<Math.abs(c)){a=c;s=p/4;}else{s=p/(2*Math.PI)*Math.asin(c/a);}if(t<1){return-0.5*(a*Math.pow(2,10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p))+b;}return a*Math.pow(2,-10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p)*0.5+c+b;};